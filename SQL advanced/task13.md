
Основные затруднения при решении задач — это приблизительное понимание предметной области. Вернее, стык предметной области с отображением ее на таблицы базы данных. Особенно в части строковых констант, с помощью которых храним свойства.

Изначально обнаружил способность писать огромные запросы, используя отступы. На простых запросах это позволяло думать по мере их написания. На сложных задачах это приводит к громоздким и неоптимальным решениям.

Как возможное решение — это попробовать мышление письмом с акцентом на предметной области и на её реализации в базе данных.

Другой/в дополнение вариант — это использовать псевдокод, похожий на существующие библиотеки Linq и еще что-то похожее, вроде встречал в Python.

Что я и попробую сделать при частичном сравнении решений:


|                             | Эталонное решение                                                                              | у меня                                                                                                                                                                                                                                                            | Комментарий                                                                                                                      |
| --------------------------- | ---------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| total_battles               | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.COUNT(report_id)                                       | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.COUNT(report_id)                                                                                                                                                                                                          | +                                                                                                                                |
| victories                   | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.SUM(1)<br>.WHERE(outcome ='Victory' )                  | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.SUM(1)<br>.WHERE(outcome ='victory' )                                                                                                                                                                                     | +                                                                                                                                |
| victory_percentage          | total_battles/victories\*100                                                                   | ttotal_battles/victories                                                                                                                                                                                                                                          | +                                                                                                                                |
| total_casualties            | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.SUM(casualties)                                        | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.SUM(casualties)                                                                                                                                                                                                           | + но у меня переменная называется casualties,<br>total_casualties лучше, но тогда и total_victories должно быть вместо victories |
| total_members_ever          | SQUAD_MEMBERS<br>.GROUPBY(squad_id)<br>.COUNT_DISTINCT(dwarf_id)                               | SQUAD_MEMBERS<br>.GROUPBY(squad_id)<br>.COUNT(dwarf_id)                                                                                                                                                                                                           | +/-<br>если гном приходил и уходил то он посчитается дважды.<br>                                                                 |
| casualty_rate               | total_casualties/total_members_ever                                                            | У меня было в решении: посчитать количество участников на начало битвы, это получить из того сколько к отряду присоединилось до начала битвы и сколько ушло до начала битвы. Это count_on_start_batle. <br>И далее какой процент от этого числа total_casualties. | -<br><br>чрезмерное усложнение, в котором скорее всего есть ошибка                                                                |
| total_enemy_casualties      | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.SUM(casualties)                                        | SQUAD_BATTLES<br>.GROUPBY(squad_id)<br>.SUM(casualties)                                                                                                                                                                                                           | +<br>у меня название<br>enemy_casual                                                                                             |
| casualty_exchange_ratio     | total_enemy_casualties/casualty_rate                                                           | otal_enemy_casualties/casualty_rate                                                                                                                                                                                                                               | +                                                                                                                                |
| current_members             | SQUAD_MEMBERS<br>.GROUPBY(squad_id)<br>.COUNT_DISTINCT(dwarf_id)<br>.WHERE_ISNULL(exit_reason) | SQUAD_MEMBERS<br>.GROUPBY(squad_id)<br>.COUNT_DISTINCT(dwarf_id, join_date)<br>-<br>SQUAD_MEMBERS<br>.GROUPBY(squad_id)<br>.COUNT_DISTINCT(dwarf_id, exit_date)                                                                                                   | +/-                                                                                                                              |
| overall_effectiveness_score |                                                                                                | у меня значительно проще                                                                                                                                                                                                                                          | субъективная сложность выбранного подхода не позволила, выйти на более сложную формулу                                           |



Основная цель этой рефлексии — получить какой-то удобный язык описания до написания SQL.